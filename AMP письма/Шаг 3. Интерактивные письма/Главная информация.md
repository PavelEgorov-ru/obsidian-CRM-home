Продублирую сюда необходимы ссылки
документация - https://amp.dev/documentation/examples/email/components/amp-bind.email/
компонент - https://amp.dev/documentation/components/email/amp-bind
действия и события в AMP письмах - https://amp.dev/documentation/guides-and-tutorials/email/learn/amp-email-actions-and-events

До сих пор наши email-письма были статичны. Их содержимое нельзя менять, пользователь может только читать текст, смотреть картинки и переходить по ссылкам. Да, мы добавили такую штуку, как карусель. Но это не меняет сути. Этот компонент лишь показа контент по другому.

Для AMP-писем доступен компонент `amp-bind`. С помощью этого компонента мы можем сделать динамичный интерфейс в AMP-письмах. Как мини-веб-приложения, которые реагируют на действия пользователя в реальном времени.
 
Компонент `amp-bind` дает возможность:
- хранить данные внутри письма
- изменять эти данные в ответ на клики, выбор опций и другие действия пользователей
- мгновенно обновлять содержимое письма после обновления данных

Механика `amp-bind` держится на трех китах:
- State
- Expressions.
- Bindings.

#### State

Внутренне состояние письма. Чтобы письмо было динамичным, оно должно уметь помнить информацию. Какой чек-бокс выбран, какой слайд в карусели виден или скрыт и тп. 

Состояние определяется с помощью тега `<amp-state>` Внутрь него помещается JSON-объект, который содержит в себе все переменные, которые необходимы для работы логики письма

```
<amp-state id="myState">   
	<script type="application/json">     
		{       
		"selectedSize": "M",       
		"isSectionVisible": false     
		}   
	</script> 
</amp-state>
```

У `amp-state` должен быть `id`, чтобы к нему можно было обращаться. Общий размер данных внутри него не должен превышать 100 Кб

Состояние можно менять в зависимости от событий и действий в письме. Состояние, События и Действия - это неравная система письма

Цепочку можно описать так:
1. Письмо имеет начальное состояние (дефолтное)
2. Происходит какое-то событие. Это триггер. Пользователь что-то сделал в письме. Например, переключил слайд в карусели.
3. Действие - это то, что должно произойти при очередном событии: 
   - с каким-то другим элементом, изменилось его состояние
   - измениться общее состояние письма


`<button on="tap:AMP.setState({myState: {isSectionVisible: true}})">   Показать окно </button>`

- `tap:` — мы реагируем на событие клика.
- `AMP` — это специальная "цель", которая обозначает саму AMP-систему.
- `.setState()` — это действие, которое изменяет состояние.
- `{myState: {isPopupVisible: true}}` — мы передаем объект, который будет "слит" с текущим состоянием (merge). `myState` — это `id` нашего `<amp-state>`, а `isSectionVisible: true` — новое значение.

**Важный нюанс:** `AMP.setState()` не заменяет все состояние целиком, а именно _объединяет_ (merge) данные. Если бы в `myState` были другие переменные, они бы не изменились.

#### Expressions

Выражение, которое описывает изменение состояния. Оно в AMP JS-подобное. В целях безопасности часть элементов языка JS не доступны: функции, циклы и многое другое. Все разрешенные выражения описаны в [документации](https://amp.dev/documentation/components/email/amp-bind#expressions).

#### Bindings

Итак, у нас есть данные (состояние) и способ их менять (действия) . Но как заставить письмо визуально отреагировать на эти изменения? Для этого существуют специальный синтаксис, который позволяет управлять атрибутами html в зависимости от состояния письма. Когда состояние меняется, атрибут мгновенно обновляется.

Привязка — это специальный атрибут, который связывает свойство HTML-элемента с данными из состояния. Когда данные в состоянии меняются, привязанный атрибут мгновенно обновляется.

```
<!-- Текст этого span будет взят из переменной 'selectedSize' в состоянии --> 
<span [text]="myState.selectedSize">M</span> 

<!-- Этот div будет скрыт, если 'isSectionVisible' равно false, и показан, если true --> <div [hidden]="!myState.isSectionVisible">Какой-то текст</div>
```

Внутри кавычек привязки можно использовать не только имена переменных, но и простые JavaScript-подобные выражения. Например `myState.product.price * myState.quantity` или `!myState.isPopupVisible`. Набор этих выражений строго ограничен. Нельзя использовать циклы, сложные условия или произвольные функции. Это сделано намеренно для защиты от XSS-атак, что делает `amp-bind` безопасным для почтовых клиентов.

#### Цикл интерактивности

1. Пользователь совершает **действие** (например, кликает по кнопке).
2. Срабатывает **событие** `tap`, которое запускает действие `AMP.setState()`.
3. **Состояние** (`amp-state`) обновляется.
4. `amp-bind` автоматически обнаруживает изменение и пересчитывает все **привязки**.
5. Элементы на странице мгновенно обновляют свой вид.

## Разбор примеров писем

[[Письмо с пазлом]] 