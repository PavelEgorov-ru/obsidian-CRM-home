Перед прочтением ознакомится с предыдущими материалами:
- [[Первое использование AMP компонента]]

На этом шаге данный материал, наверное, будет самым обширным. Будет много примеров писем и ссылок на них.

До текущего момента нам для использования AMP компонента не требовалось ничего, кроме использования тега сразу в верстке. `amp-img` - единственный компонент, который можно так использовать. Для остальных нужно подключать специальные скрипты в тег `head`. Письмо, в котором есть скрипты неиспользуемых компонентов, не пройдет валидацию.
## amp-anim

документация - https://amp.dev/documentation/examples/email/components/amp-anim.email/
компонент - https://amp.dev/documentation/components/email/amp-anim

Подключение - 
`<script async custom-element="amp-anim"  src="https://cdn.ampproject.org/v0/amp-anim-0.1.js"></script>` 

В обычном веб- и email-весртке для изображения используется один тег - `img`. Он может работать как со статическим изображением (.png, .img и т.д.), так и с gif. В AMP-верстке это не так. Для работы гиф в письме требуется отдельный компонент - `amp-anim`.

Главная причина появления этого AMP компонента - оптимизация. Вообще, все AMP компоненты нужны либо для оптимизации, либо для безопасности.

В обычном браузере, гифка загружается через тег `img` и начинает непрерывно проигрываться. Браузер тратить ресурсы устройства, устройство быстрее тратит свою энергию. 

`amp-anim` проигрывает гифку только тогда, когда она находится во вьюпорте. Т.е. анимация проигрывается только тогда, когда пользователь видит ее на экране устройства.

Можно использовать в двух вариантах

```
Первый вариант. Если гифка не загрузится, какое-то время будет показываться лоадер загрузки, потом - текст из атрибута alt

<div>
	<amp-anim width="900" height="197" src="https://trafaret-decor.art/sites/default/files/animatepeoples/kids/funny%20(6).gf" alt="гифка"         layout="responsive">
	</amp-anim>
</div>
```

Гиф-анимация часто бывает тяжелой и не может сразу загрузиться на устройство. Пока она полностью не загрузится, можно показывать статическое изображение.

```
Второй вариант. Внутрь помещают amp-img и добавляют к нему атрибут placeholder.

Чтобы не было скачков контента при переключении отображения с amp-img на amp-anim, нужно указывать им одинаковые атрибуты ширины, высоты и layout

<div>
	<amp-anim width="900" height="197" src="https://trafaret-decor.art/sites/default/files/animatepeoples/kids/funny%20(6).gf" alt="гифка"         layout="responsive">
		<amp-img placeholder width="900" height="197" src="https://rassylka.static1-sima-land.com/ftp_rassylka/000032743-1/0000.png" layout="responsive">
		</amp-img>
	</amp-anim>
</div>
```

Не рекомендуется использовать много анимации, особенно тяжелой. Нужно не забывать оптимизировать и сжимать каждую гифку.

В целом, про этот компонент мне больше нечего сказать.


## amp-carousel

документация - https://amp.dev/documentation/examples/email/components/amp-carousel.email/
компонент - https://amp.dev/documentation/components/email/amp-carousel

Подключение - 
`<script async custom-element="amp-carousel" src="https://cdn.ampproject.org/v0/amp-carousel-0.1.js"></script>`

`amp-carousel` — это компонент, который позволяет создавать прокручиваемые галереи контента (слайдеры) прямо внутри письма.

Для чего может использоваться, особенно в email-письмах:
- Экономия места. Можно упаковать в компактный блок большой объем информации. Для ее просмотра не нужно скролить вниз письма.
- Письмо становится больше похоже на веб страницу

Как и все (большинство?) AMP-компонентов, `amp-carousel` требует указания атрибутов - `width` и  `height` для резервирования пространства во время рендера письма.

#### Два вида amp-carousel

##### `type="carousel"`

"Ленточная" карусель. Она отображает **несколько элементов одновременно** в виде непрерывной горизонтальной полосы. Прокрутка плавная, без "привязки" к конкретному элементу.

Особенности:
- Плавная прокрутка. Пользователь может остановить прокрутку в любом месте, даже между двумя элементами
- Можно самостоятельно определить ширину каждого элемента внутри карусели с помощью CSS. Они не растягиваются на всю ширину карусели.
- По умолчанию у этого типа нет встроенной навигации. Взаимодействие происходит через свайп (на мобильных) или мышью/тачпадом на десктопе.

Основная задача - просмотр большого количества однотипных элементов.

Как можно использовать в email-письмах:
1. Рекомендации товаров. Пользователь может быстро просмотреть десятки вариантов в компактном блоке без скрола, не покидая письмо.
2. Подборка статей или новостей. Что-то типа блока "Читайте также".
3. Горизонтальное меню категорий интернет-магазина
4. Галерея фото в карточке товара
5. Галерея логотипов спонсоров какого-нибудь оффлайн или онлайн события

**Поддерживаемые `layout`.** 
- `fixed` - и лента, и ее содержимое будут иметь фиксированные размеры. Прокрутка будет работать внутри этого фиксированного блока. Редко используется. Для ленты это нелогично. **`width` и `height`: Обязательны**.
- ==`responsive` - контейнер карусели будет адаптивным, но внутри него все равно будет горизонтальная прокрутка. **`width` и `height`: Обязательны**. Это может быть полезно, если нужно, чтобы высота ленты менялась в зависимости от ширины экрана, сохраняя пропорции. Но чаще всего для ленты нужна именно фиксированная высота.==
- `fixed-height` - самый часто используемый вариант. Задается фиксированную высота для "ленты", а она может бесконечно скролиться по горизонтали. **`width` и `height`: Обязательны**. Для атрибута `width` установить `auto`.

**Layout элементов карусели:**
- `layout="responsive"` и `layout="fill"` - **запрещены**. Эти layout заставили бы каждый элемент попытаться занять 100% ширины контейнера карусели, что полностью сломает идею "ленты". Вы получите один элемент на всю ширину, а остальные будут скрыты. AMP-валидатор выдаст ошибку.
- `fixed` - все элементы имеют фиксированную ширину и высоту (заранее известные размеры). Не применять если карусель имеет `layout="responsive"`
```
<amp-carousel type="carousel" layout="fixed-height" height="150" width="auto">
  <!-- Карточки товаров фиксированного размера -->
  <amp-img src="..." layout="fixed" width="100" height="150"></amp-img>
  <amp-img src="..." layout="fixed" width="100" height="150"></amp-img>
</amp-carousel>
```
- `flex-item` - это наверное идеальный вариант. Используется, нужно управлять размерами элементов с помощью CSS Flexbox. `<amp-carousel type="carousel">` по сути и есть flex-контейнер. Это более гибкий подход, чем `fixed`.
```
<style amp-custom>
 .flex-card { flex: 0 0 120px; margin: 0 5px; } /* Ширина 120px, отступы */
</style>
<amp-carousel type="carousel" layout="fixed-height" height="150" width="auto">
 <div class="flex-card">...</div>
 <div class="flex-card">...</div>
</amp-carousel>
```
- `intrinsic` - Также хороший вариант. Элемент будет адаптивным (уменьшаться при необходимости), но не будет растягиваться больше своих натуральных размеров. Полезно для карточек с текстом разной длины. ==(проработать)==

##### `type="slides"`

Слайдер. Он отображает **один элемент за раз**, который занимает всю площадь карусели.
С текущего элемента можно перейти на следующий или предыдущий элемент.

Особенности:
- Пошаговая прокрутка. Нельзя остановиться между слайдами.
- Встроенное управление. Можно добавить кнопки навигации (атрибут `controls`) и зацикливание (при переключении с последнего элемента на следующий, показывается первый элемент из списка. Управляется атрибутом `loop`)
- Автопроигрывание. Его можно включить с помощью атрибута `autoplay`. С помощью атрибута `delay` можно указать задержку переключения. По умолчанию 5000 мс. Минимальное значение - 1000 мс.

Как можно использовать в email-письмах:
1. Главный рекламный баннер. В шапке письма размещается слайдер с 2-3 основными акциями
2. Обзор в карточке одного товара с разных ракурсов.
3. Пошаговая инструкция или онбординг: шаг 1, шаг 2 и т.д.
4. Отзывы клиентов. Один слайд - один отзыв

**Поддерживаемые `layout`.** 
-  `responsive` - контейнер карусели занимает 100% ширины родительского элемента, а его высота подбирается для сохранения пропорций, заданных `width` и `height`. **`width` и `height`: Обязательны**.
- `fixed`- контейнер карусели имеет строго фиксированные размеры, заданные `width` и `height`. **`width` и `height`: Обязательны**. Можно использовать для неадаптивных баннеров или виджетов точного размера.
- `fixed-height` - контейнер карусели имеет фиксированную высоту, а ширина подстраивается под родительский контейнер. **`width` и `height`: Обязательны**. Для атрибута `width` установить `auto`.
- `fill`- контейнер карусели заполняет все пространство родительского контейнера (у которого должно быть `position: relative` или подобное). **`width` и `height`:** **НЕ НУЖНЫ**. Возможно применение в редких случаях, когда карусель является частью другой сложной компоновки.

**Layout элементов слайдера:**
- `fill`- самый частый вариант. Этот layout приказывает элементу (например, `<amp-img>`) растянуться и полностью заполнить своего родителя. Так как родитель — это слайд, который имеет размеры контейнера карусели, изображение идеально вписывается в слайдер.
```
<amp-carousel type="slides" layout="responsive" width="16" height="9">
  <!-- Этот amp-img занимает всё пространство слайда -->
  <amp-img src="..." layout="fill"></amp-img> 
</amp-carousel>
```
- `responsive` - технически будет работать, так как `layout="responsive"` заставляет элемент занять 100% ширины родителя (слайда), что дает тот же эффект, что и `fill`. Но `fill` более семантически корректен в данном контексте, так как он управляет и высотой, и шириной.
- `fixed`, `intrinsic`, `fixed-height` - их можно использовать, если нужно, чтобы контент **не занимал** весь слайд, а был, например, отцентрирован внутри него. В этом случае прямым потомком карусели должен быть `<div>`, а уже внутри него — элемент с нужным layout.
```
<style amp-custom>
  .slide-wrapper { display: flex; align-items: center; justify-content: center; }
</style>
<amp-carousel type="slides" layout="responsive" width="16" height="9">
  <div class="slide-wrapper">
     <amp-img src="icon.svg" layout="fixed" width="50" height="50"></amp-img>
  </div>
</amp-carousel>
```

#### Стилизация amp-carousel

Саму карусель можно стилизовать двумя способами:
- использовать селекторы класса или id
- использовать селектор тега `amp-carousel`

Элементы карусели аналогично:
- использовать селекторы классов или id
- использовать селекторы тегов из которых состоят элементы карусели или класс `.amp-carousel-slide`

Управление кнопками слайдера:
- `.amp-carousel-button-next ` 
- `.amp-carousel-button-prev`
- `.amp-carousel-button[disabled]`
